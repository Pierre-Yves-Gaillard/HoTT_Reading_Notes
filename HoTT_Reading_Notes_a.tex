% HoTT_Reading_Notes_a
% http://goo.gl/Dz6r8g
% https://docs.google.com/document/d/15-yaLYocktW8PtUeiKjTupslbpdnDs0HH5GIZA20Sxc/edit
% https://github.com/Pierre-Yves-Gaillard/HoTT_Reading_Notes/blob/master/HoTT_Reading_Notes_a.tex 
% http://iecl.univ-lorraine.fr/~Pierre-Yves.Gaillard/HoTT/ReadingNotes
% https://docs.google.com/document/d/15-yaLYocktW8PtUeiKjTupslbpdnDs0HH5GIZA20Sxc/edit?usp=sharing
% !TEX encoding = UTF-8 Unicode
\documentclass[12pt]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amssymb,amsmath}
\usepackage[a4paper]{geometry}
\usepackage[pdfusetitle]{hyperref}
\usepackage{datetime}
\addtolength{\parskip}{.5\baselineskip}
%\renewcommand{\baselinestretch}{1.1}
%\pagestyle{empty}
\newcommand{\mbb}{\mathbb}
\newcommand{\mbf}{\mathbf}
\newcommand{\msf}{\mathsf}
\newcommand{\ack}{\mathsf{ack}}
\newcommand{\ap}{\mathsf{ap}}
\newcommand{\cc}{\cdot}
\newcommand{\dd}{\displaystyle}
\newcommand{\ee}{\equiv}
\newcommand{\fu}{\mathsf{funext}}
\newcommand{\id}{\mathsf{id}}
\newcommand{\ind}{\mathsf{ind}}
\newcommand{\inl}{\mathsf{inl}}
\newcommand{\inr}{\mathsf{inr}}
\newcommand{\la}{\lambda}
\newcommand{\N}{\mathbb N}
\newcommand{\nn}{\noindent}
\newcommand{\oo}{\operatorname}
\newcommand{\p}{\varphi}
\newcommand{\pr}{\mathsf{pr}}
\newcommand{\rec}{\mathsf{rec}}
\newcommand{\refl}{\mathsf{refl}}
\newcommand{\sm}{\scriptstyle}
\newcommand{\su}{\mathsf{succ}}
\newcommand{\two}{\mathbf2}
\newcommand{\U}{\mathcal U}
\newcommand{\ua}{\mathsf{ua}}
\newcommand{\uniq}{\mathsf{uniq}}
\title{HoTT Reading Notes}
\author{Pierre-Yves Gaillard}
\date{\today, \currenttime}
\begin{document}
% $$\text{mathbf }\mathbf1,\text{ pmb }\pmb1,\text{ boldsymbol }\boldsymbol1$$ \tiny, \scriptsize, \footnotesize, \small, \normalsize, \large, \Large, \LARGE, \huge, \Huge

\maketitle%\nn\today, \currenttime

\nn This text is available at 

\nn{\small\verb"http://iecl.univ-lorraine.fr/~Pierre-Yves.Gaillard/HoTT/ReadingNotes"}

\nn\verb"https://github.com/Pierre-Yves-Gaillard/HoTT_Reading_Notes"

\nn\verb"http://goo.gl/Dz6r8g"

This is an informal set of comments on the HoTT Book:

\nn\verb"http://homotopytypetheory.org/book/"

This is work in progress. John Dougherty's text 

\nn\verb"https://github.com/jdoughertyii/hott-exercises"

\nn has been most helpful.

\tableofcontents%\newpage

%%

\section{Exercise 1.3} 

\emph{Statement.} Derive the induction principle for products $\ind_{A\times B}$, using only the projections and the propositional uniqueness principle $\uniq_{A\times B}$. Verify that the definitional equalities are valid. Generalize $\uniq_{A\times B}$ to $\Sigma$-types, and do the same for $\Sigma$-types. \emph{(This requires concepts from Chapter~2.)}

\nn\emph{Solution.} It suffices to handle $\Sigma$-types. 

\nn(a) We assume that, for all type family $B:A\to\U$ we have a map 
$$
\pr_1:\left(\sum_{a:A}B(a)\right)\to A,
$$ 
a dependent function 
$$
\pr_2:\prod_{x:\sum_{a:A}B(a)}B(\pr_1(x))
$$
satisfying
\begin{equation}\label{131}
\pr_1(a,b)\equiv a,\quad\pr_2(a,b)\equiv b
\end{equation}
for all $a:A$ and all $b:B(a)$.

\nn(b) We also assume that, for all type family $B:A\to\U$ we have a dependent function 
$$
\uniq_{\sum_{a:A}B(a)}:\prod_{x:\sum_{a:A}B(a)}(\pr_1(x),\pr_2(x))=x
$$ 
such that 
\begin{equation}\label{132}
\uniq_{\sum_{a:A}B(a)}(a,b)\equiv\refl_{(a,b)}
\end{equation}
for all $a:A$ and all $b:B(a)$. 

\nn(c) We define
$$
\ind_{\sum_{a:A}B(a)} : \prod_{C:\sum_{a:A}B(a)\to\U} 
\left(\prod_{a:A}\prod_{b:B(a)} C((a,b))\right) 
\to \prod_{x:\sum_{a:A}B(a)} C(x)
$$
thanks to the transport principle, which is indeed a concept from Chapter~2, by
\begin{equation}\label{133}
\ind_{\sum_{a:A}B(a)}(C,g,x):
\equiv\uniq_{\sum_{a:A}B(a)}(x)_*\Big(g(\pr_1(x))(\pr_2(x))\Big).
\end{equation}
(d) We must prove 
$$
\ind_{\sum_{a:A}B(a)}(C,g,(a,b))\equiv g(a)(b)
$$
for all $a:A$ and all $b:B(a)$. But this follows from \eqref{131}, \eqref{132} and \eqref{133}.

%%

\section{Exercise 1.5}

\emph{Statement.} Show that if we define $A+B:\equiv\sum_{x:\two}\rec_\two(\U,A,B,x)$, then we can give a definition of $\ind_{A+B}$ for which the definitional equalities stated in \S1.7 hold.

\nn\emph{Solution.} We define $\inl:A\to A+B$ by $\inl(a):\equiv(0_\two,a)$, and we define $\inr$ similarly. Let $C:A+B\to\U$ be given, and put 
$$
A':\equiv\prod_{a:A}C(\inl(a)),\quad B':\equiv\prod_{b:B}C(\inr(b)).
$$
We must define 
$$
\ind_{A+B}:\prod_{C:A+B\to\U}A'\to B'\to\prod_{x:A+B}C(x).
$$ 
Let $g_0:A',g_1:B'$ be given. We must define 
$$
\ind_{A+B}(C,g_0,g_1):\prod_{x:A+B}C(x).
$$ 
Set $T:\equiv\rec_\two(\U,A,B):\two\to\U$. We define $D:\two\to\U$ by 
$$
D(n):\equiv\prod_{u:T(n)}C((n,u)).
$$ 
Note that $D(0_\two)\equiv A'$ and $D(1_\two)\equiv B'$. Recall that 
$$
\ind_\two(D):D(0_\two)\to D(1_\two)\to\prod_{n:\two}D(n).
$$ 
In particular we have 
$$
\ind_\two(D,g_0,g_1):\prod_{n:\two}\ \prod_{u:T(n)}C((n,u)).
$$ 
Since 
$$
\ind_{\sum_{n:\two}T(n)}(C):\left(\prod_{n:\two}\ \prod_{u:T(n)}C((n,u))\right)\to\prod_{x:A+B}C(x),
$$ 
we can put 
$$
\ind_{A+B}(C,g_0,g_1):\equiv\ind_{\sum_{n:\two}T(n)}(C,\ind_\two(D,g_0,g_1)).
$$ 
We must check 
\begin{equation}\label{15a}
\ind_{A+B}(C,g_0,g_1,(0_\two,a))\equiv g_0(a),
\end{equation}
\begin{equation}\label{15b}
\ind_{A+B}(C,g_0,g_1,(1_\two,b))\equiv g_1(b).
\end{equation} 
We have 
\begin{align*}
\ind_{A+B}(C,g_0,g_1,(0_\two,a))&\equiv\ind_{\sum_{n:\two}T(n)}(C,\ind_\two(D,g_0,g_1)\\ 
&\equiv\ind_\two(D,g_0,g_1)(0_\two)(a)\\ 
&\equiv g_0(a),
\end{align*}
the three definitional equalities following respectively from the definitions of the dependent functions
$$
\ind_{A+B},\quad\ind_{\sum_{n:\two}T(n)},\quad\ind_\two.
$$ 
This proves \eqref{15a}. The proof of \eqref{15b} is similar.

%%

\section{Exercise 1.6}

\emph{Statement.} Show that if we define $A\times B:\equiv\prod_{x:\two}\rec_\two(\U,A,B,x)$, then we can give a definition of  $\ind_{A\times B}$ for which the definitional equalities stated in \S1.5 hold propositionally (i.e. using equality types). \emph{(This requires the function extensionality axiom, which is introduced in \S2.9.)}

\nn\emph{Solution.} As above put $T:\equiv\rec_\two(\U,A,B):\two\to\U$, so that $A\times B:\equiv\prod_{n:\two}T(n)$, and 
$$
\ind_\two(T):A\to B\to A\times B.
$$ 
For $a:A,b:B$ we abbreviate $\ind_\two(T,a,b)$ by $(a,b)$; in particular we have 
$$
(a,b):A\times B,\quad(a,b)(0_\two)\equiv a,\quad(a,b)(1_\two)\equiv b.
$$ 
Let $C:A\times B\to\U$. We must define 
$$
\ind_{A\times B}(C):\left(\prod_{a:A}\prod_{b:B}C((a,b))\right)\to\prod_{u:A\times B}C(u).
$$ 
Define $D:\two\to\U$ by 
$$
D(n):\equiv\Big(\big(u(0_\two),u(1_\two)\big)(n)=u(n)\Big)
$$ 
and recall that 
$$
\ind_\two(D):D(0_\two)\to D(1_\two)\to\prod_{n\in\two}D(n)
$$ 
and that 
$$
\fu:\prod_{n\in\two}D(n)\to\Big(\big(u(0_\two),u(1_\two)\big)=u\Big).
$$
We get 
$$
\alpha:\equiv\ind_\two(D,\refl_{u(0_\two)},\refl_{u(1_\two)}):\prod_{n\in\two}D(n),\quad\fu(\alpha):\Big(\big(u(0_\two),u(1_\two)\big)=u\Big),
$$
$$
\fu(\alpha)_*:C((u(0_\two),u(1_\two)))\to C(u).
$$
In particular we can set
$$
\ind_{A\times B}(C,g,u):\equiv\fu(\alpha)_*(g(u(0_\two))(g(u(1_\two)).
$$

To show that the definitional equalities stated in \S1.5 hold propositionally, we assume $u\equiv(a,b)$. In particular we have 
$$
\alpha:\prod_{n\in\two}\Big((a,b)(n)=(a,b)(n)\Big).
$$ 
It is easy to prove $\alpha(n)=\refl_{(a,b)(n)}$ by induction. This gives 
$$
\ind_{A\times B}(C,g,(a,b))=g(a)(b),
$$ 
as required.

%%

\section{Exercise 1.8}

\emph{Statement.} Define multiplication and exponentiation using $\rec_\N$. Verify that $(\N,+,0,\times,1)$ is a semiring using only $\ind_\N$. You will probably also need to use symmetry and transitivity of equality, Lemmas 2.1.1 and 2.1.2.

\nn\emph{Solution.} We put
$$
\msf{mult}:\equiv\rec_\N(\N\to\N,\la m.0,\la m.\la g.\la n.m+g(m)),
$$
$$
\msf{exp}:\equiv\rec_\N(\N\to\N,\la m.1,\la m.\la g.\la n.mg(m)).
$$ 
We omit the verification of the fact that $(\N,+,0,\times,1)$ is a semiring.

%%

\section{Exercise 1.10}

\emph{Statement.} Show that the Ackermann function $\ack :\N\to\N\to\N$ is definable using only $\rec_\N$ satisfying the following equations:
\begin{align*}
\ack(0,n)&\equiv\su(n),\\
\ack(\su(m),0)&\equiv\ack(m,1),\\
\ack(\su(m),\su(n))&\equiv\ack(m,\ack(\su(m),n)).
\end{align*}

\nn\emph{Solution.} I have used John Dougherty's text 

\nn\verb"https://github.com/jdoughertyii/hott-exercises"

We try to solve Equation 
\begin{equation}\label{ack1}
\ack:\equiv\rec_\N(C,c_0,c_s)
\end{equation}
for $C:\U,c_0:C,c_s:\N\to C\to C$. We get $C:\equiv(\N\to\N)$, and evaluation at 0 gives $c_0\equiv\su$. Let $i:\N,f:\N\to\N$. It suffices to solve Equation 
\begin{equation}\label{ack2}
c_s(i,f):\equiv\rec_\N(D,d_0(i,f),d_s(i,f))
\end{equation}
for $D:\U,d_0(i,f):D,d_s(i,f):\N\to D\to D$. We get $D:\equiv\N$. We have
\begin{align*}
\ack(\su(n))&\equiv\rec_\N(C,\su,c_s,\su(m))\\
&\equiv c_s(m,\rec_\N(C,\su,c_s,m))\\
&\equiv c_s(m,\ack(m))\\
&\equiv\rec_\N(\N,d_0(m,\ack(m)),d_s(m,\ack(m))),
\end{align*}
and evaluation at 0 yields $d_0(m,\ack(m))\equiv\ack(m)(1)$, prompting us to set $$d_0(i,f):\equiv f(1).$$ We have 
\begin{align*}
\ack(m)\big(\ack(\su(m),n)\big)&\equiv\ack\big(m,\ack(\su(m),n)\big)\\ 
&\equiv\ack(\su(m),\su(n))\\ 
&\equiv\rec_\N\big(\N,\ack(m,1),d_s(m,\ack(m)),\su(n)\big)\\
&\equiv d_s\big(m,\ack(m)\big)\big(n,\ack(\su(m),n)\big),
\end{align*}
prompting us to set $d_s(i,f)(x,y):\equiv f(y)$. 

Abbreviating $d_s(i,f)$ by $f'$, we get 
$$
\ack:\equiv\rec_\N(\N\to\N,\su,c_s)
$$ 
with 
$$ 
c_s(i,f)\equiv\rec_\N(\N,f(1),f')
$$ 
for 
$$ 
i:\N,\quad f:\N\to\N,\quad f':\N\to\N\to\N,\quad f'(x,y):\equiv f(y).
$$

%%

\section{Exercise 1.13}

\emph{Statement.} Using propositions-as-types, derive the double negation of the principle of excluded middle, i.e. prove \emph{not (not ($P$ or not $P$))}.

\nn\emph{Solution.} Here is a slightly stronger statement: For any types $A,B,C$ the types

(a) $\big((A+B)\to C\big)\to\big((A\to C)\times(B\to C)\big)$,

(b) $\big((A\to C)\times(B\to C)\big)\to\big((A+B)\to C\big)$,

(c) $(A\to B)\to A\to B$,

(d) $\Big(\big(A+(A\to B)\big)\to B\Big)\to\Big((A\to B)\times\big((A\to B)\to B\big)\Big)$, 

(e) $\Big((A\to B)\times\big((A\to B)\to B\big)\Big)\to B$,

(f) $\Big(\big(A+(A\to B)\big)\to B\Big)\to B$

\nn are inhabited. The proof that (a), (b), (c) are inhabited is left to the reader. The fact that (a) and (c) are inhabited implies that (d) and (e), and thus (f), are inhabited. Putting $B:\equiv\mbf0$ in (f) gives the desired result.

%%

\section{Comment after Corollary 2.7.3}

If $w,w':\sum_{x:A}P(x)$, then 
$$
\msf{pair}^=:\left(\sum_{p:p_1w=p_1w'}(p_*p_2w=p_2w')\right)\to(w=w').
$$ 
(It would be more rigorous to write $\msf{pair}^=(w,w')$ instead of $\msf{pair}^=$.)

%%

\section{Proof of Theorem 2.11.1}

Let $f:A\to B$ be an equivalence, and let $a,a':A$. We must show that 
$$
\ap_f:(a=a')\to (fa=fa')
$$ 
is an equivalence.

Step 1. (This step is the the same as in the book; I spell it out for the reader's convenience.) Let $g:B\to A$ be a quasi-inverse to $f$, let $\beta:g\circ f=\id_A$, and define 
$$
\varphi:(gfa=gfa')\to(a=a')\quad\text{by}\quad\varphi(q):\equiv\beta_a^{-1}\cdot q\cdot\beta_{a'}.
$$ 
Note, as in the book, that the equality $\varphi\circ\ap_g\circ\ap_f=\id_{a=a'}$ follows from the functoriality of $\ap$ and the naturality of homotopies, Lemmas 2.2.2 and 2.4.3. (Here $\ap_g:(fa=fa')\to (gfa=gfa')$.)

Step 2. Since $\varphi$ is easily seen to be an equivalence, $\ap_g\circ\ap_f$ is also an equivalence, and so is, by symmetry, $\ap_f\circ\ap_g$. This implies that $\ap_f$ and $\ap_g$ are equivalences.

%old: https://docs.google.com/document/d/1OvMAEN0uvE18rTCHAmZAIYKiILQ_FNT5JJqNH3HH760/edit

%%

\section{Section 3.7}

A question about Propositional Truncation:

Is the type 
$$
\left(\prod_{A\in\mathcal U}\ \lVert A\rVert\to A\right)\to\mathbf0
$$ 
inhabited?

%%

\section{Proof of Lemma 4.1.2}

The claim

\nn ``It remains to show that $h$ is identified with $h'$ when transported along this equality, which by transport in identity types and function types, reduces to showing 
$$
h(s)=h(p)\cdot h'(p)^{-1}\cdot h'(s)
$$ 
for any $s:a=x$''

\nn in the proof of Lemma 4.1.2 in the HoTT Book follows immediately from Theorem 2.7.2 and the Lemma below, which is easily proved by path induction:

\nn \textbf{Lemma.} Let $A$ be a type; let $a,x:A$; let $q:a=a$; let $P:(x=x)\to\U$ be defined by 
$$
P(r):\equiv\prod_{s:a=x}(r=s^{-1}\cdot q\cdot s);
$$ 
let $r,r':x=x,\ t:r=r',\ h:P(r),\ s:a=x$. Then 
$$
\oo{transport}^P(t,h)(s)=t^{-1}\cdot h(s).
$$ 

To complete the proof of Lemma 4.1.2, we set $f(x):\ee\msf{pr}_1(k(x))$ with $k:\prod_{x:A}B(x)$.
%https://github.com/HoTT/book/blob/master/equivalences.tex#L107

%%

%\nn$\bullet$ Proof of Theorem 4.1.3.

%The fact that $\two\simeq\two$ is a set follows from univalence and Examples 3.1.2 and 3.1.5.

%%

\section{Proof of Theorem 4.7.6}

Let us check Equivalence $(*)$ in the proof of Theorem 4.7.6: For $a:A$ and $p:a=x$ put 
$$
Q(a,p):\equiv\sum_{u:P(a)}p_*(f(a,u))=v.
$$ 
We claim 
$$
\sum_{a:A}\sum_{p:a=x}Q(a,p)\overset{(\text a)}{\simeq}
\sum_{q:\sum_{a:A}(a=x)}Q(q)\overset{(\text b)}{\simeq}
Q(x,\refl_x).
$$
Equivalence (a) follows from Exercise 2.10. As Lemma 3.11.8 implies that $$\sum_{a:A}\ (a=x)$$ is contractible with center $(x,\refl_x)$, Equivalence (b) follows from Lemma 3.11.9 (ii). 

%%

\section{Proof of Theorem 4.8.3}

Here are some details about the last sentence of the proof of Theorem 4.8.3:

Firstly we rewrite (2.9.4) as follows. Abbreviating transport by $t$ we have 
\begin{equation}\label{2.9.4}
t^{A\to B}(p,f,a_2)=t^B(p,f(t^A(p^{-1},x)))
\end{equation}
for $p:x_1=_Xx_2,\ f:A(x_1)\to B(x_1),\ a_2:A(x_2)$. 

Now let us move to last sentence of the proof of Theorem 4.8.3. Put
$$
F:\equiv\sum_{b:B}\oo{fib}_f(b),
$$ 
and let $p_1:F\to B$ be the first projection. We must show 
\begin{equation}\label{2}
(F,p_1)=_{\sum_{X:\U}X\to B}(A,f).
\end{equation} 
We have $e:F\simeq A$. Put $q:\equiv\ua(e)$. We have $q:F=A$. We claim 
\begin{equation}\label{3}
q_*(p_1)=f.
\end{equation} 
By Theorem 2.7.2, \eqref{3} will imply \eqref{2}. For all $X:\U$ set $I(X)\equiv X,\ C(X)\equiv B$. Then \eqref{3} becomes, in the notation of (2.9.4), 
$$
t^{I\to C}(q,p_1)=f.
$$ 
Let $a:A$. We must show 
$$
t^{I\to C}(q,p_1,a)=f(a).
$$ 
We get 
$$
t^{I\to C}(q,p_1,a)\overset{\text{(a)}}=t^C(q,p_1(t^I(q^{-1},a)))\overset{\text{(b)}}=p_1(e^{-1}(a))\overset{\text{(c)}}=f(a),
$$ 
where (a) follows from \eqref{2.9.4}, (b) follows from the computation rule for univalent stated right after Remark 2.10.4, and (c) follows from the definition of $e^{-1}$.

%%

\section{Proof of Theorem 4.8.4}

The proof of Theorem 4.8.4 uses the following lemma: For $A:\U$ we have 
$$
A\simeq\sum_{X:\U}\ (X=A)\times X.
$$
More precisely, we shall define maps 
$$
A\rightleftarrows\sum_{X:\U}\ (X=A)\times X
$$ 
and check that they are mutual quasi-inverses. To $a:A$ we attach $(A,\refl_A,a)$, and to $(B,p,b)$ we attach $t^{X\mapsto X}(p,b)$. Here and in the sequel we write $t$ for "transport". We have 
$$
a\mapsto(A,\refl_A,a)\mapsto t^{X\mapsto X}(\refl_A,a)\equiv a.
$$ 
We have 
$$
(B,p,b)\mapsto t^{X\mapsto X}(p,b)\mapsto(A,\refl_A,t^{X\mapsto X}(p,b)),
$$ 
and we must show 
$$
(B,p,b)=(A,\refl_A,t^{X\mapsto X}(p,b)).
$$ 
By Theorem 2.7.2 it suffices to verify 
$$
t^{X\mapsto (X=A)\times X}(p,(p,b))=(\refl_A,t^{X\mapsto X}(p,b)).
$$ 
By Theorem 2.6.4 it suffices to prove 
$$
t^{X\mapsto (X=A)}(p,p)=\refl_A.
$$ 
But this follows from Lemma 2.11.2.

%%

\section{Display (6.2.2)}

In the setting of Lemma 2.3.4, we have 
$$
\msf{adp}_f(p):f(x)=^P_pf(y).
$$

%%

\section{Proof of Corollary 6.4.3}

Recall the following facts: 

A type $A$ is a set if and only if $x=y$ is a mere proposition for all $x,y:A$ (observation stated just before Lemma 3.3.4). 

A mere proposition is a set (Lemma 3.3.4).

A type is contractible if and only if it is an inhabited mere proposition (Lemma 3.11.3). 

The proof of Corollary 6.4.3 uses the following fact:

Let $A$ and $B$ be types, let $f,g:A\to B$, let $u:\mathsf{isequiv}(f),\ u:\mathsf{isequiv}(g)$, so that $(f,u),(g,v):A\simeq B$. Put $C:\equiv\mathsf{isequiv}(g), D(p):\equiv(p_*(u)=_Cv)$. By Theorem 2.7.2 we have 
$$
((f,u)=(g,v))\simeq\sum_{p:f=g}D(p).
$$ 
We claim that the first projection 
$$
p_1:\sum_{p:f=g}D(p)\to(f=g)
$$ 
is an equivalence. This will imply 
$$
((f,u)=(g,v))\simeq(f=g).
$$ 
By Theorem 4.2.13 and the above reminders, $D(p)$ is contractible for all $p$, and Lemma 3.11.9 (i) implies that $p_1$ is indeed an equivalence.

%%

\section{Proof of Lemma 6.5.1}

The first display follows from Theorem 2.11.3.

%%

\section{Appendix A}

It seems to me that the expression $\lambda x.b$ is defined in two conflicting ways, firstly at the beginning of A.1, and secondly in the last sentence of A.2.4. 

\end{document}
